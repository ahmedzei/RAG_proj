You can speed up the map function by setting batched=True to process multiple elements of the dataset at once, and increasing the number of processes with num_proc.
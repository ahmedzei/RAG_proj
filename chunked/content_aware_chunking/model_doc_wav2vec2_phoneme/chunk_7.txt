This model was contributed by patrickvonplaten
The original code can be found here.
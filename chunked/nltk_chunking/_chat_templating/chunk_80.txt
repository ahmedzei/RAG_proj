Advanced: How do chat templates work?
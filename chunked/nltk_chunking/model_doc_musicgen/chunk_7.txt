Instead, it is able to generate all the codebooks in a single forward pass.
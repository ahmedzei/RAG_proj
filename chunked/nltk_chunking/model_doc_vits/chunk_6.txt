The model is trained end-to-end with a combination of losses derived from variational lower bound and adversarial training.
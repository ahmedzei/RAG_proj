The rest of the code remains unchanged.